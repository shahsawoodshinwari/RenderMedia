import{O as E}from"./OfficialLogo-DDCOSBZM.js";import{m as T,p as L,q as K,s as h,o as c,c as m,a as d,F as R,k as U,n as _,x as $,t as F,y as j,_ as B,u as P,d as b,r as w,b as C,e as k,i as W}from"./index-BOfF0Tsz.js";import{u as z}from"./index-DzsK4FRY.js";const Z=["disabled"],G={class:"m-input-code__wrapper"},H=["inputmode","pattern","required","value","onInput","onKeydown","onClick"],J=T({inheritAttrs:!1,__name:"MazInputCode",props:{style:{default:void 0},class:{default:void 0},modelValue:{default:void 0},codeLength:{default:4},type:{default:"text"},acceptAlpha:{type:Boolean,default:!1},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},error:{type:Boolean,default:!1},success:{type:Boolean,default:!1},warning:{type:Boolean,default:!1},size:{default:"md"},color:{default:"primary"},hint:{}},emits:["update:model-value","completed"],setup(i,{emit:o}){const s=i,v=o,a=L([]),l=L(new Map);K(()=>s.modelValue,(e,t)=>{e!==t&&(l.value=u())},{immediate:!0});const f=h({get:()=>l.value,set:e=>{const t=N(e);v("update:model-value",t),(t==null?void 0:t.toString().length)===s.codeLength&&v("completed")}});function u(e=s.modelValue){const t=new Map;for(const n of Array.from({length:s.codeLength},(r,p)=>p))if(e===void 0)t.set(n+1,void 0);else{const r=[...e.toString()];t.set(n+1,r[n])}return t}function A(e,t){var n;const r=x((n=e.target)==null?void 0:n.value);f.value=l.value.set(t,r),r&&y(t)}function N(e){const t=[...e.values()].join("");return s.type==="text"?t:t&&!Number.isNaN(Number(t))?Number(t):void 0}function x(e){var t;return(t=s.acceptAlpha?e.match(/^[\w.]$/):e.match(/\d+/g))==null?void 0:t.toString()}function I(e,t){const n=l.value.get(t);if(e.key==="ArrowRight"&&y(t),e.key==="ArrowLeft"&&y(t-2),e.key==="Backspace"&&!n){const r=t-1<0?0:t-1;f.value=l.value.set(r,void 0),y(r-1)}}function M(e){var t;const n=(t=e.clipboardData)==null?void 0:t.getData("text");if(!n)return;const r=Array.from({length:s.codeLength},(p,g)=>({index:g+1,value:[...n.toString()][g]??void 0}));for(const{index:p,value:g}of r){const V=g?x(g):void 0;V&&l.value.set(p,V)}setTimeout(()=>{const p=O(),g=p>=s.codeLength?s.codeLength-1:p;y(g,!1)},0)}function O(){return[...l.value.values()].filter(Boolean).length}function y(e,t=!0){setTimeout(()=>{const n=a.value[e];e+1>s.codeLength||!n||(n.focus(),t&&S(e))},0)}function S(e){const t=a.value[e];e+1>s.codeLength||!t||t.select()}const D=h(()=>s.error?"!maz-border-danger":s.success?"!maz-border-success":s.warning?"!maz-border-warning":""),q=h(()=>`var(--maz-color-${s.color})`);return(e,t)=>(c(),m("fieldset",{class:_(["m-input-code m-reset-css",[e.size?`--${e.size}`:void 0,s.class]]),disabled:e.disabled,style:j([e.style,{"--input-border-color":q.value}])},[d("div",G,[(c(!0),m(R,null,U(e.codeLength,n=>(c(),m("div",{key:n,class:_(["input-wrapper",D.value])},[d("input",$({ref_for:!0,ref:r=>{a.value[n-1]=r},type:"text",minlength:"1",maxlength:"1",inputmode:e.acceptAlpha?"text":"numeric",pattern:e.acceptAlpha?"[a-zA-Z0-9]{1}":"[0-9]{1}",autocomplete:"do-not-autofill",required:e.required},e.$attrs,{value:f.value.get(n),onInput:r=>A(r,n),onKeydown:r=>I(r,n),onClick:r=>S(n-1),onPaste:M}),null,16,H)],2))),128))]),d("span",{class:_(["m-input-code__hint",{"--error":e.error,"--success":e.success,"--warning":e.warning}])},F(e.hint),3)],14,Z))}}),Q=(i,o)=>{const s=i.__vccOpts||i;for(const[v,a]of o)s[v]=a;return s},X=Q(J,[["__scopeId","data-v-dbb4e5e8"]]),Y={name:"VerifyForm",components:{MazInputCode:X},data(){return{form:z("post","/email/verify",{code:""}),resendCodeForm:z("post","/email/resend",{}),toast:P()}},computed:{userFullName(){return b().getFullName()},isVerified(){return b().isUserVerified}},methods:{onSubmit(){this.form.submit().then(()=>{b().updateVerifiedStatus(!0),this.$router.push({name:"home"})}).catch(i=>{console.log(i)})},resendCode(){this.resendCodeForm.processing||this.resendCodeForm.submit().then(i=>{this.toast.success(i.data.message)}).catch(i=>{console.log(i.response.data.message)})}}},ee={class:"col-12"},te={class:"text-center"},oe={key:0,class:"text-danger"},se={class:"col-8"},ne=["disabled"],re={key:0,class:"spinner-border spinner-border-sm",role:"status"},ae={key:1,class:"text-uppercase fw-bold"},ie={class:"col-12 text-center"},de=["disabled"],le={key:0,class:"spinner-border spinner-border-sm ms-2",role:"status"};function ue(i,o,s,v,a,l){const f=w("MazInputCode");return c(),m("form",{onSubmit:o[2]||(o[2]=W((...u)=>l.onSubmit&&l.onSubmit(...u),["prevent"])),class:"row justify-content-center g-3"},[d("div",ee,[d("div",te,[C(f,{modelValue:a.form.code,"onUpdate:modelValue":o[0]||(o[0]=u=>a.form.code=u),error:a.form.invalid("code"),codeLength:5,size:"xs"},null,8,["modelValue","error"]),a.form.invalid("code")?(c(),m("div",oe,F(a.form.errors.code),1)):k("",!0)])]),d("div",se,[d("button",{class:"btn btn-primary w-100",disabled:a.form.processing},[a.form.processing?(c(),m("div",re,o[3]||(o[3]=[d("span",{class:"visually-hidden"},"Loading...",-1)]))):(c(),m("span",ae,"Continue"))],8,ne)]),d("div",ie,[d("a",{type:"button",onClick:o[1]||(o[1]=(...u)=>l.resendCode&&l.resendCode(...u)),disabled:a.resendCodeForm.processing,class:"btn-card"},[o[5]||(o[5]=d("span",null,"RESEND CODE",-1)),a.resendCodeForm.processing?(c(),m("div",le,o[4]||(o[4]=[d("span",{class:"visually-hidden"},"Loading...",-1)]))):k("",!0)],8,de)])],32)}const ce=B(Y,[["render",ue]]),me={name:"LoginView",components:{VerifyForm:ce,OfficialLogo:E}},fe={class:"text-center mb-4"};function pe(i,o,s,v,a,l){const f=w("OfficialLogo"),u=w("VerifyForm");return c(),m("div",null,[d("div",fe,[C(f),o[0]||(o[0]=d("h1",{class:"text-capitalize fw-bold"},"verify your email",-1)),o[1]||(o[1]=d("p",{class:"w-75 mx-auto"}," We sent a 5-Digit verification code to your register email address. ",-1))]),C(u)])}const he=B(me,[["render",pe]]);export{he as default};
